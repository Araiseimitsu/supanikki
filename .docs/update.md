## 更新履歴

### 2025-12-12 (最新)

- **ホットキーシステムの完全刷新**:
  - `keyboard` ライブラリから `pynput` へ移行し、他アプリ操作中でも確実に動作するように改善
  - デバウンス処理（300ms）を追加し、誤った連続トリガーを防止
  - 60秒ごとにホットキーリスナーの状態を監視し、停止時に自動復旧する機能を追加
  - スレッドセーフなロック機構でホットキーの登録・解除を保護
  - メモリ使用量を最適化（不要なイベントキュー処理を削減）

- **UI表示の軽量化**:
  - `update_idletasks()` の呼び出しを最小化し、描画処理を高速化
  - フォーカス処理を最適化し、ウィンドウ表示時のレスポンスを向上
  - デスクトップ常駐時のCPU・メモリ負荷を軽減

- **デフォルトホットキーの変更**:
  - `ctrl+shift+space` をデフォルトに設定（より使いやすいキーコンビネーション）

### 2025-12-12

- **.gitignore を整備**: Python/Windows生成物と、Google OAuth関連の機密ファイル（`token.json`/`credentials.json` 等）を除外
- **.docs/ を追加**: `AGENTS.md` / `CLAUDE.md` / `copilot-instructions.md` / `update.md` を新設
- **Driveアップロード機能を追加**:
  - 入力欄へのドラッグ&ドロップでファイルをDriveへアップロード
  - アップロードURLを改行で入力欄へ追記し、従来どおりEnterでスプレッドシートに保存
  - 共有権限は変更しない（自分のみ閲覧）
  - 追加依存: `google-api-python-client`, `tkinterdnd2`

### 2025-12-11

- **Driveスコープを拡張**:
  - 既存のDriveフォルダ配下へアップロードできるよう `drive.file` → `drive` に変更
  - 初回起動時に再認証が走る（`token.json` が古いスコープの場合）
  - フォルダID/URLの権限不足や誤指定時は、原因が分かるエラーメッセージを返すよう改善

- **入力UI改善**:
  - 入力欄右に「送信」ボタンを追加（クリックでもEnterでも送信）
  - 入力行が増えると入力欄とウィンドウ高さが自動で拡張されるように変更
  - ドラッグ&ドロップ時に即「アップロード中: ファイル名...」を表示し、完了後にURLへ置換

- **ホットキー安定化**:
  - ホットキーコールバックの例外でリスナーが落ちないよう保護
  - 押下状態がスタックして効かなくなる症状に対し、トグル後に押下キャッシュをクリア

- **トレイメニュー追加**:
  - アップロード先Driveフォルダを開く「Open Upload Folder」を追加
  - アプリを再起動する「Restart」を追加
  - ショートカットキーを変更できる「Change Hotkey」を追加（設定は `settings.json` に保存）
